<%- include("_header") -%>

<main class="container mt-4">
    <div class="text-center mb-4">
        <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
        <h1 class="mt-3">Castração Registrada!</h1>
        <p class="lead">Sua inscrição foi realizada com sucesso.</p>
    </div>

    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="bi bi-ticket-perforated me-2"></i>Comprovante de Inscrição</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Ticket:</strong> <span class="text-danger fw-bold" style="font-size: 2rem; border: 2px solid #dc3545; padding: 5px 15px; border-radius: 5px;"><%= castracao.ticket %></span></p>
                    <p><strong>Responsável:</strong> <%= castracao.nome %></p>
                    <p><strong>Contato:</strong> <%= castracao.contato %></p>
                    <% if (castracao.whatsapp) { %>
                        <p><strong>WhatsApp:</strong> <%= castracao.whatsapp %></p>
                    <% } %>
                    <% if (castracao.locality) { %>
                        <p><strong>Localidade:</strong> <%= castracao.locality %></p>
                    <% } %>
                </div>
                <div class="col-md-6">
                    <p><strong>Tipo:</strong> <span class="badge bg-<%= castracao.tipo === 'mutirao' ? 'warning' : (castracao.tipo === 'pets_rua' ? 'info' : 'success') %>"><%= castracao.tipo === 'mutirao' ? 'Mutirão' : (castracao.tipo === 'pets_rua' ? 'Pet de Rua' : 'Baixo Custo') %></span></p>
                    <p><strong>Clínica:</strong> <%= castracao.clinica || 'A definir' %></p>
                    <p><strong>Dia Preferencial:</strong> <%= castracao.agenda || 'A definir' %></p>
                    <p><strong>Data do Cadastro:</strong> <%= castracao.origem ? new Date(castracao.origem).toLocaleDateString('pt-BR') : 'Hoje' %></p>
                </div>
            </div>
            
            <hr>
            
            <h5>Dados do Pet</h5>
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead class="table-dark">
                        <tr>
                            <th>Nome</th>
                            <th>Espécie</th>
                            <th>Porte</th>
                            <th>Idade</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong><%= castracao.nome_pet || '-' %></strong></td>
                            <td><%= castracao.especie ? (castracao.especie.charAt(0).toUpperCase() + castracao.especie.slice(1)) : '-' %></td>
                            <td><%= castracao.porte || '-' %></td>
                            <td><%= castracao.idade || '-' %> anos</td>
                            <td><span class="badge bg-warning"><%= castracao.status || 'PENDENTE' %></span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="card-footer text-center">
            <a href="/castracao/comprovante/<%= castracao.ticket %>" class="btn btn-primary btn-lg" target="_blank">
                <i class="bi bi-file-earmark-pdf me-2"></i>Guardar Comprovante
            </a>
            <a href="/castracao" class="btn btn-outline-secondary btn-lg ms-2">
                <i class="bi bi-arrow-left me-2"></i>Voltar
            </a>
        </div>
    </div>

    <div class="alert alert-info">
        <i class="bi bi-info-circle me-2"></i>
        <strong>Importante:</strong> Guarde o comprovante (PDF) e apresente-no no dia da castração. Você também pode tirar um print desta tela.
    </div>
</main>

<!-- Modal de Sucesso -->
<div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title"><i class="bi bi-check-circle-fill me-2"></i>Castração Registrada</h5>
                
            </div>
            <div class="modal-body text-center">
                <p class="lead">Sua inscrição foi realizada com sucesso!</p>
                <p><strong>Ticket:</strong> <span class="text-danger fw-bold" style="font-size: 2rem; border: 2px solid #dc3545; padding: 5px 15px; border-radius: 5px; display: inline-block;"><%= castracao.ticket %></span></p>
                <p class="text-muted">Guarde seu ticket para apresentar no dia da castração.</p>
            </div>
            <div class="modal-footer justify-content-center">
                <a href="/castracao/comprovante/<%= castracao.ticket %>" class="btn btn-primary" target="_blank">
                    <i class="bi bi-file-earmark-pdf me-2"></i>Guardar Comprovante
                </a>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var successModal = new bootstrap.Modal(document.getElementById('successModal'));
    successModal.show();
});
</script>

<%- include("_footer") -%>
