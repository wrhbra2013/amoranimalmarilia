 <%- include("_header") -%>

 <style>
     .relatorio-container {
         max-width: 1400px;
         margin: 0 auto;
         padding: 20px;
     }
     
     .selector-section {
         background: var(--container-bg);
         border: 1px solid var(--border-color);
         border-radius: 12px;
         padding: 25px;
         margin-bottom: 30px;
         box-shadow: 0 2px 10px var(--container-shadow);
     }
     
     .selector-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
         gap: 15px;
         margin-top: 20px;
     }
     
     .report-option {
         background: var(--card-bg);
         border: 2px solid var(--border-color);
         border-radius: 8px;
         padding: 15px;
         cursor: pointer;
         transition: all 0.3s ease;
         text-align: center;
         position: relative;
     }
     
     .report-option:hover {
         border-color: var(--brand-teal);
         transform: translateY(-2px);
         box-shadow: 0 4px 15px rgba(0,0,0,0.1);
     }
     
     .report-option.active {
         border-color: var(--brand-coral);
         background: linear-gradient(135deg, var(--brand-coral), var(--brand-coral-2));
         color: white;
     }
     
     .report-option i {
         font-size: 2em;
         margin-bottom: 10px;
         color: var(--brand-teal);
         display: block;
     }
     
     .report-option.active i {
         color: white;
     }
     
     .report-title {
         font-weight: 600;
         margin-bottom: 5px;
         font-size: 1.1em;
     }
     
     .report-desc {
         font-size: 0.85em;
         opacity: 0.8;
     }
     
     .data-section {
         background: var(--container-bg);
         border: 1px solid var(--border-color);
         border-radius: 12px;
         overflow: hidden;
         box-shadow: 0 2px 10px var(--container-shadow);
     }
     
     .section-header {
         background: linear-gradient(135deg, var(--brand-teal), var(--brand-teal-2));
         color: white;
         padding: 20px 25px;
         display: flex;
         justify-content: between;
         align-items: center;
     }
     
     .section-title {
         font-size: 1.5em;
         font-weight: 600;
         margin: 0;
     }
     
     .table-modern {
         width: 100%;
         border-collapse: separate;
         border-spacing: 0;
     }
     
     .table-modern thead {
         background: var(--nav-bg);
         color: var(--nav-text);
     }
     
     .table-modern th {
         padding: 15px 12px;
         text-align: left;
         font-weight: 600;
         border-bottom: 2px solid var(--brand-teal);
         position: sticky;
         top: 0;
         z-index: 10;
     }
     
     .table-modern td {
         padding: 12px;
         border-bottom: 1px solid var(--border-color);
         vertical-align: middle;
     }
     
     .table-modern tbody tr {
         transition: background-color 0.2s ease;
     }
     
     .table-modern tbody tr:hover {
         background-color: var(--hover-bg);
     }
     
     .table-modern tbody tr:nth-child(even) {
         background-color: var(--alternate-bg);
     }
     
     .action-buttons {
         display: flex;
         gap: 8px;
         justify-content: center;
     }
     
     .btn-action {
         padding: 6px 12px;
         border: none;
         border-radius: 6px;
         cursor: pointer;
         font-size: 0.9em;
         transition: all 0.2s ease;
         display: inline-flex;
         align-items: center;
         gap: 5px;
     }
     
      .btn-delete {
          background: #dc3545;
          color: white;
          padding: 6px 10px;
          border-radius: 6px;
          border: none;
          cursor: pointer;
      }
      
      .btn-delete:hover {
          background: #c82333;
          transform: translateY(-1px);
      }
     
     .export-section {
         display: flex;
         gap: 15px;
         justify-content: center;
         margin-top: 30px;
         padding: 20px;
         background: var(--container-bg);
         border-radius: 12px;
         border: 1px solid var(--border-color);
     }
     
     .btn-export {
         padding: 12px 24px;
         border: none;
         border-radius: 8px;
         font-weight: 600;
         cursor: pointer;
         transition: all 0.3s ease;
         display: inline-flex;
         align-items: center;
         gap: 8px;
         text-decoration: none;
     }
     
     .btn-pdf {
         background: linear-gradient(135deg, var(--brand-coral), var(--brand-coral-2));
         color: white;
     }
     
     .btn-pdf:hover {
         transform: translateY(-2px);
         box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
     }
     
     .empty-state {
         text-align: center;
         padding: 60px 20px;
         color: var(--text-muted);
     }
     
     .empty-state i {
         font-size: 4em;
         margin-bottom: 20px;
         opacity: 0.5;
     }
     
     .empty-state h3 {
         margin-bottom: 10px;
         color: var(--text-color);
     }
     
     @media (max-width: 768px) {
         .selector-grid {
             grid-template-columns: 1fr;
         }
         
         .table-modern {
             font-size: 0.9em;
         }
         
         .table-modern th,
         .table-modern td {
             padding: 8px 6px;
         }
         
         .action-buttons {
             flex-direction: column;
         }
     }
 </style>

<div class="relatorio-container">
      <!-- Seletor de Tabelas do Banco de Dados -->
      <div class="selector-section">
          <h2 class="mb-3"><i class="bi bi-database me-2"></i>Selecionar Tabela</h2>
          <p class="text-muted">Escolha uma tabela do banco de dados para visualizar os dados</p>
          
          <div class="mb-3">
              <label for="tableSelect" class="form-label">Tabelas do Banco de Dados:</label>
              <select class="form-select" id="tableSelect" onchange="window.location.href='/relatorio/' + this.value">
                  <option value="">-- Selecione uma tabela --</option>
                  <% if (typeof todasTabelas !== 'undefined' && todasTabelas.length > 0) { %>
                      <% todasTabelas.forEach(function(table) { %>
                          <option value="<%= table %>" <%= (typeof tabela !== 'undefined' && tabela === table) ? 'selected' : '' %>>
                              <%= table %>
                          </option>
                      <% }); %>
                  <% } %>
              </select>
          </div>
      </div>

      
     <!-- Seção de Dados -->
     <% if (typeof tabela !== 'undefined' && tabela) { %>
         <div class="data-section">
             <div class="section-header">
                 <div>
                     <h1 class="section-title">
                         <% 
                         const reportTitles = {
                             'adocao': 'Adoção',
                             'adotante': 'Adotantes', 
                             'adotado': 'Adotados',
                             'castracao': 'Castração',
                             'procura_se': 'Procura-se',
                             'parceria': 'Parcerias',
                             'voluntario': 'Voluntários',
                             'interesse_voluntario': 'Interesse Voluntariado',
                             'interessados_adocao': 'Interesse Adoção',
                             'coleta': 'Coleta',
                             'login': 'Acessos ao Sistema'
                         };
                         const title = reportTitles[tabela] || tabela.charAt(0).toUpperCase() + tabela.slice(1);
                         %>
                         <i class="bi bi-database me-2"></i><%= title %>
                     </h1>
                 </div>
                 <div>
                     <span class="badge bg-light text-dark">
                         <%= typeof model !== 'undefined' && model.length ? model.length + ' registros' : '0 registros' %>
                     </span>
                 </div>
             </div>
             
             <% if (typeof model !== 'undefined' && model.length > 0) { %>
                 <div style="overflow-x: auto;">
                     <table class="table-modern">
                         <thead>
                             <% if (model.length > 0) { %>
                                 <tr>
                                     <% const firstItem = model[0]; %>
                                     <% for (const key in firstItem) { %>
                                         <th>
                                             <%= key.charAt(0).toUpperCase() + key.slice(1).replace(/_/g, ' ') %>
                                         </th>
                                     <% } %>
                                     <th style="text-align: center; min-width: 100px;">Ações</th>
                                 </tr>
                             <% } %>
                         </thead>
                         <tbody>
                              <% for (const item of model) { %>
                                  <tr>
                                      <% for (const key in item) { %>
                                          <td><%= item[key] || '-' %></td>
                                      <% } %>
                                      <td>
                                          <% if (item.id) { %>
                                          <div class="action-buttons">
                                              <form action="/relatorio/delete/<%= tabela %>/<%= item.id %>?_method=DELETE" method="POST" style="margin: 0;">
                                                  <button type="submit" class="btn-action btn-delete" title="Excluir Registro" onclick="return confirm('Tem certeza que deseja excluir este registro? Esta ação não pode ser desfeita.')">
                                                      <i class="bi bi-trash"></i>
                                                  </button>
                                              </form>
                                          </div>
                                          <% } else { %>
                                          <span class="text-muted">-</span>
                                          <% } %>
                                      </td>
                                  </tr>
                              <% } %>
                         </tbody>
                     </table>
                 </div>
             <% } else { %>
                 <div class="empty-state">
                     <i class="bi bi-inbox"></i>
                     <h3>Nenhum Dado Encontrado</h3>
                     <p>Não há registros disponíveis para o relatório selecionado.</p>
                 </div>
             <% } %>
         </div>
         
         <!-- Seção de Exportação -->
         <% if (typeof model !== 'undefined' && model.length > 0) { %>
             <div class="export-section">
                 <form action="/relatorio/<%= tabela %>" method="post" style="margin: 0;">
                     <button type="submit" class="btn-export btn-pdf" onclick="return confirm('Gerar relatório PDF com todos os dados?');">
                         <i class="bi bi-file-earmark-pdf"></i>
                         Gerar Relatório PDF
                     </button>
                 </form>
                 
                 <a href="javascript:history.back()" class="btn-export" style="background: var(--button-bg); color: var(--button-text);">
                     <i class="bi bi-arrow-left"></i>
                     Voltar
                 </a>
             </div>
         <% } %>
     <% } else { %>
         <div class="data-section">
             <div class="empty-state">
                 <i class="bi bi-graph-up"></i>
                 <h3>Selecione um Relatório</h3>
                 <p>Escolha uma das opções acima para visualizar os dados correspondentes.</p>
             </div>
         </div>
     <% } %>
 </div>

 <script>
 document.addEventListener('DOMContentLoaded', function() {
     // Adiciona feedback visual ao clicar nos cards de relatório
     const reportOptions = document.querySelectorAll('.report-option');
     reportOptions.forEach(option => {
         option.addEventListener('click', function() {
             // Remove loading state após um breve momento
             setTimeout(() => {
                 this.style.transform = '';
             }, 300);
         });
     });
     
     // Melhora a acessibilidade da tabela
     const tableRows = document.querySelectorAll('.table-modern tbody tr');
     tableRows.forEach(row => {
         row.setAttribute('tabindex', '0');
         row.addEventListener('keypress', function(e) {
             if (e.key === 'Enter') {
                 this.click();
             }
         });
     });
 });
 </script>

 <%- include("_footer") -%>
 